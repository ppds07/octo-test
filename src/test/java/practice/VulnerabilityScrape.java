package practice;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;

public class VulnerabilityScrape {
	public static List<String> scrapvulnerability(WebDriver driver,String pageUrl,String wpVersion){
		driver.get(pageUrl);
		List<WebElement> table=driver.findElements(By.xpath("//table//tr"));
		List<String> cvid=new ArrayList<>();
		for(WebElement row:table) {
			
			List<WebElement> cells=row.findElements(By.tagName("td"));
			
			if((cells.get(4).getText()).equals(wpVersion)) {
				cvid.add(cells.get(0).getText());
				
			}
		}
		return cvid;
		
	}
	public static String highest(WebDriver driver,String pageUrl,String wpVersion) {
		driver.get(pageUrl);
		double highest=0.0;
		String id=" ";
		List<WebElement> rows=driver.findElements(By.xpath("//table//tr"));
		
		for(WebElement row:rows) {
			List<WebElement> cells=row.findElements(By.tagName("tr"));
			if(Double.parseDouble(cells.get(3).getText())>highest){
				highest=Double.parseDouble(cells.get(3).getText());
				id=cells.get(0).getText();
			}
		}
		return id;
		
		
		
		
		
		
	}

}
